## âœ¨ Milestone 4: Polish & Performance (1 day)

### Step 19: Add Accessibility Improvements

Update `src/components/MovieCard.jsx` to improve accessibility:
```tsx
// Add these utility classes to your CSS for better visual feedback
// Add to src/index.css

@layer components {
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
}
```

### Step 20: Add Error Boundaries

Create `src/components/ErrorBoundary.jsx`:
```jsx
import React, { Component } from 'react';

export default class ErrorBoundary extends Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false };
  }

  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }

  componentDidCatch(error, errorInfo) {
    console.error('Uncaught error:', error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return (
        <div className="min-h-screen flex items-center justify-center bg-gray-50">
          <div className="text-center">
            <div className="text-6xl mb-4">ðŸ˜•</div>
            <h1 className="text-2xl font-bold text-gray-900 mb-2">
              Something went wrong
            </h1>
            <p className="text-gray-600 mb-4">
              We're sorry, but something unexpected happened.
            </p>
            <button
              onClick={() => window.location.reload()}
              className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
            >
              Reload Page
            </button>
          </div>
        </div>
      );
    }

    return this.props.children;
  }
}
```

Update `src/App.jsx` to include ErrorBoundary:
```tsx
import ErrorBoundary from './components/ErrorBoundary';

// Wrap the entire app
function App() {
  return (
    <ErrorBoundary>
      <QueryClientProvider client={queryClient}>
        {/* ... rest of app */}
      </QueryClientProvider>
    </ErrorBoundary>
  );
}
```

### Step 21: Add Basic Testing

Create `src/components/__tests__/SearchBar.test.jsx`:
```jsx
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import SearchBar from '../SearchBar';

describe('SearchBar', () => {
  it('renders with placeholder text', () => {
    render(<SearchBar value="" onChange={() => {}} onClear={() => {}} />);
    expect(screen.getByPlaceholderText('Search for movies...')).toBeInTheDocument();
  });

  it('calls onChange when form is submitted', async () => {
    const mockOnChange = vi.fn();
    const user = userEvent.setup();
    
    render(<SearchBar value="" onChange={mockOnChange} onClear={() => {}} />);
    
    const input = screen.getByRole('textbox');
    await user.type(input, 'Star Wars');
    await user.keyboard('{Enter}');
    
    expect(mockOnChange).toHaveBeenCalledWith('Star Wars');
  });

  it('calls onClear when clear button is clicked', async () => {
    const mockOnClear = vi.fn();
    const user = userEvent.setup();
    
    render(<SearchBar value="test" onChange={() => {}} onClear={mockOnClear} />);
    
    const clearButton = screen.getByLabelText('Clear search');
    await user.click(clearButton);
    
    expect(mockOnClear).toHaveBeenCalled();
  });
});
```

Update `vite.config.js` for testing:
```javascript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: './src/test/setup.js',
  },
})
```

Create `src/test/setup.js`:
```javascript
import '@testing-library/jest-dom';
```

### Step 22: Performance Optimizations

Create `src/components/LazyImage.jsx`:
```jsx
import { useState } from 'react';

export default function LazyImage({ src, alt, className, fallback }) {
  const [loaded, setLoaded] = useState(false);
  const [error, setError] = useState(false);

  if (error && fallback) {
    return <>{fallback}</>;
  }

  return (
    <div className={`relative ${className}`}>
      {!loaded && (
        <div className="absolute inset-0 bg-gray-200 animate-pulse rounded" />
      )}
      <img
        src={src}
        alt={alt}
        className={`${className} transition-opacity duration-300 ${
          loaded ? 'opacity-100' : 'opacity-0'
        }`}
        onLoad={() => setLoaded(true)}
        onError={() => setError(true)}
        loading="lazy"
      />
    </div>
  );
}
```

### Step 23: Add Meta Tags and SEO

Update `index.html`:
```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Search and discover movies with detailed information and save your favorites" />
    <meta name="keywords" content="movies, search, cinema, films, entertainment" />
    <title>Movie Search App</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
```

### Step 24: Final Testing and Validation

Run tests:
```bash
npm run test
```

Build for production:
```bash
npm run build
```

Preview production build:
```bash
npm run preview
```

Run Lighthouse audit (in browser dev tools) and verify:
- Performance score â‰¥ 85
- Accessibility score â‰¥ 90
- Best practices score â‰¥ 90
- No console errors

---
